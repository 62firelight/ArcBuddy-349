<div *ngIf="fetchingStats">
    <mat-spinner [diameter]="50">
    </mat-spinner>
    Fetching stats...
</div>

<div *ngIf="profile != undefined && fetchingStats == false">

    <h1> {{ profile.displayName }} <img class="profile-icon" [src]="profile.iconPath"></h1>

    <mat-card-subtitle> Last Updated: {{ profile.dateCreated | date : 'short'}}
    </mat-card-subtitle>

    <div class="row">
        <div class="column left">
            <app-characters [characters]="profile.characters" [currentId]="currentId"
                (newCharacterIdEvent)="updateStats($event)">
            </app-characters>
        </div>

        <div class="column right">
            <h2> Stats </h2>

            <button mat-raised-button [disabled]="profile.mergedStats == undefined" (click)="addProfile(profile)">
                Save Stats
            </button>
            <br>
            <br>

            <mat-button-toggle-group [(ngModel)]="currentMode" (change)="displayedStats=getMode(currentMode)">
                <mat-button-toggle value="Merged">All</mat-button-toggle>
                <mat-button-toggle value="PvE">PvE</mat-button-toggle>
                <mat-button-toggle value="PvP">PvP</mat-button-toggle>
            </mat-button-toggle-group>

            <!-- <mat-tab-group mat-align-tabs="center">
                <mat-tab label="Merged">
                    <div class="stat-section"
                        *ngIf="fetchingStats == false && checkEmptyObject(displayedStats) == false">
                        <app-stat-section *ngFor="let section of sections | keyvalue: helper.numberedKeyOrder"
                            [section]="section.value" [sectionName]="section.key"
                            [displayedStats]="getMode('Merged')" [newDisplayedStatsEvent]="newDisplayedStatsEvent">
                        </app-stat-section>
                    </div>
                </mat-tab>
                <mat-tab label="PvE">
                    <div class="stat-section"
                        *ngIf="fetchingStats == false && checkEmptyObject(displayedStats) == false">
                        <app-stat-section *ngFor="let section of sections | keyvalue: helper.numberedKeyOrder"
                            [section]="section.value" [sectionName]="section.key"
                            [displayedStats]="getMode('PvE')" [newDisplayedStatsEvent]="newDisplayedStatsEvent">
                        </app-stat-section>
                    </div>
                </mat-tab>
                <mat-tab label="PvP">
                    <div class="stat-section"
                        *ngIf="fetchingStats == false && checkEmptyObject(displayedStats) == false">
                        <app-stat-section *ngFor="let section of sections | keyvalue: helper.numberedKeyOrder"
                            [section]="section.value" [sectionName]="section.key"
                            [displayedStats]="getMode('PvP')" [newDisplayedStatsEvent]="newDisplayedStatsEvent">
                        </app-stat-section>
                    </div>
                </mat-tab>
            </mat-tab-group> -->

            <div *ngIf="checkEmptyObject(displayedStats) == true">
                <br>
                <br>
                No {{ currentMode }} stats were found
            </div>

            <div class="stat-section" *ngIf="checkEmptyObject(displayedStats) == false">
                <app-stat-section *ngFor="let section of sections | keyvalue: helper.numberedKeyOrder"
                    [section]="section.value" [sectionName]="section.key" [displayedStats]="displayedStats"
                    [newDisplayedStatsEvent]="newDisplayedStatsEvent">
                </app-stat-section>
            </div>

        </div>
    </div>
</div>